{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../src/Griddler.svelte",
    "../src/Block.svelte"
  ],
  "sourcesContent": [
    "<script>\n  import _ from 'lodash';\n  import { onMount } from 'svelte';\n\timport { slide } from 'svelte/transition';\n  import { quintOut } from 'svelte/easing';\n  import { gql } from 'apollo-boost';\n  import { matrix, deepEqual } from 'mathjs';\n\n  import { generateTotals } from './utils.ts';\n  import { client, Levels } from './gql';\n  import Block from './Block.svelte';\n\n  export let props = {};\n\n  let levels;\n  let boards;\n  let level;\n  let mainDown;\n  let mainDownTarget;\n  let secondaryDown;\n\n  let levelIndex = 0;\n  let layerIndex = 0;\n  let same = false;\n\n  $: title = level ? level.title : '';\n  $: colors = level ? level.colors : '';\n  $: solution = level ? level.solution : '';\n  $: board = boards ? boards[levelIndex] : null;\n  $: color = colors ? colors[layerIndex] : null;\n  $: [rowTotals, colTotals] = (!!colors && !!solution)\n    ? generateTotals(colors, solution)[layerIndex]\n    : [[], []]\n  ;\n\n  const resetBoard = () => {\n    const width = solution[0].length;\n    const height = solution.length;\n    const _board = Array(width).fill().map(() => Array(height).fill(-1));\n    return _board;\n  }\n\n  const changeLevel = (d) => {\n    same = false;\n    levelIndex += d;\n    layerIndex = 0;\n    board = resetBoard(solution);\n  }\n\n  const setLevelIndex = index => {\n    levelIndex = index;\n    level = levels[levelIndex];\n  };\n  const setLayerIndex = index => { layerIndex = index; };\n\n  const toggleDisabled = (row, col) => (\n    board[row][col] = board[row][col] === -2\n      ? -1\n      : -2\n  );\n\n  const mouseDown = (row, col) => {\n    if (board[row][col] < -1) {\n      return false;\n    }\n\n    mainDown = true;\n    board[row][col] = board[row][col] === -1\n      ? layerIndex\n      : -1;\n    mainDownTarget = board[row][col];\n  }\n\n  const mouseEnter = (row, col) => {\n    if (mainDown && mainDownTarget !== null) {\n      board[row][col] = mainDownTarget;\n    }\n  }\n\n  const mouseUp = (row, col) => {\n    mainDown = false;\n    mainDownTarget = null;\n\n    same = deepEqual(matrix(solution), matrix(board));\n\n    if (same && levelIndex < levels.length) {\n      setLevelIndex(levelIndex + 1);\n    }\n  }\n\n  const toggleEnabled = (row, col) => {\n    if (board[row][col] < -1) {\n      return false;\n    }\n\n    board[row][col] = board[row][col] === -1\n      ? layerIndex\n      : -1;\n    same = deepEqual(matrix(solution), matrix(board));\n\n    if (same && levelIndex < levels.length) {\n      setLevelIndex(levelIndex + 1);\n    }\n  };\n\n  onMount(async () => {\n    const resp = await client.query({ query: Levels });\n    levels = resp.data.levels;\n    boards = levels.map(l => l.solution.map(r => r.map(c => -1)));\n    level = levels[levelIndex];\n  });\n</script>\n\n<style>\n  h1 {\n    color: #222;\n    font-size: 1.3rem;\n    text-align: center;\n    text-transform: uppercase;\n  }\n\n  .main {\n    background: '#fff';\n    padding: 2rem;\n  }\n\n  .flex-row {\n    display: flex;\n  }\n\n  .flex-col {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .justify-center {\n    justify-content: center;\n  }\n\n  .margin-bottom {\n    margin-bottom: 1rem;\n  }\n\n  .board {\n    display: grid;\n    grid-gap: 0px;\n  }\n</style>\n\n<div class=\"main\">\n  <h1>{levelIndex}: {title}</h1>\n  {#if levels && !!levels.length}\n    <div class=\"flex-row justify-center\" style=\"margin-bottom: 1rem\">\n      {#each levels as level, index}\n        <div\n          on:click={() => setLevelIndex(index)}\n          style=\"margin-right: 0.5rem; display: inline-block; padding: 0.5rem; background: #fff; border-radius: 4px; cursor: pointer;\"\n        >\n          {index}\n        </div>\n      {/each}\n    </div>\n  {/if}\n  {#if colors && !!colors.length}\n    <div class=\"flex-row justify-center margin-bottom\">\n      {#each colors as color, index}\n        <Block\n          state={1}\n          color={color}\n          onClick={() => { setLayerIndex(index); }}\n          styles=\"border-radius: 4px; margin: 0 4px;\"\n        >\n          {color}\n        </Block>\n      {/each}\n      <Block\n        state={-2}\n        onClick={() => resetBoard()}\n        styles=\"border-radius: 4px; margin: 0 4px;\"\n      />\n    </div>\n  {/if}\n  <div class=\"flex-row justify-center\">\n    {#if colTotals && !!colTotals.length}\n      <Block\n        color={color}\n        state={1}\n        styles=\"border-top-left-radius: 24px;\"\n      />\n      {#each colTotals as total}\n        <Block\n          color={color}\n          state={1}\n        >\n          {total}\n        </Block>\n      {/each}\n      <Block\n        color={color}\n        state={1}\n        styles=\"border-top-right-radius: 24px;\"\n      />\n    {/if}\n  </div>\n  <div class=\"flex-row justify-center\">\n    {#if rowTotals && !!rowTotals.length}\n      <div class=\"flex-col\">\n        {#each rowTotals as total}\n          <Block\n            color={color}\n            state={1}\n          >\n            {total}\n          </Block>\n        {/each}\n      </div>\n    {/if}\n    {#if board}\n      <div class=\"flex-row\">\n        <section\n          class=\"board\"\n          style=\"grid-template-columns: repeat({board[0].length}, 1fr); grid-template-rows: repeat({board.length}, 1fr);\"\n        >\n          {#each board as row, rowIndex}\n            {#each row as item, colIndex}\n              <Block\n                state={item}\n                row={rowIndex}\n                col={colIndex}\n                onMouseDown={mouseDown}\n                onMouseEnter={mouseEnter}\n                onMouseUp={mouseUp}\n                onRightClick={toggleDisabled}\n                color={colors[item]}\n                mainDown={mainDown}\n                secondaryDown={secondaryDown}\n              />\n            {/each}\n          {/each}\n        </section>\n      </div>\n    {/if}\n    {#if rowTotals && !!rowTotals.length}\n      <div class=\"flex-col\">\n        {#each rowTotals as total}\n          <Block\n            color={color}\n            state={1}\n          >\n            {total}\n          </Block>\n        {/each}\n      </div>\n    {/if}\n  </div>\n  {#if colTotals && !!colTotals.length}\n    <div class=\"flex-row justify-center\">\n      <Block\n        color={color}\n        state={1}\n        styles=\"border-bottom-left-radius: 24px;\"\n      />\n      {#each colTotals as total}\n        <Block\n          color={color}\n          state={1}\n        >\n          {total}\n        </Block>\n      {/each}\n      <Block\n        color={color}\n        state={1}\n        styles=\"border-bottom-right-radius: 24px;\"\n      />\n    </div>\n  {/if}\n  <div class=\"flex-row justify-center\">\n    {same.toString()}\n  </div>\n</div>\n",
    "<script>\n  import tinycolor from 'tinycolor2';\n\n  export let row;\n  export let col;\n  export let state = -1;\n  export let color;\n  export let onClick;\n  export let onMouseEnter;\n  export let onMouseOver;\n  export let onMouseLeave;\n  export let onMouseDown;\n  export let onMouseUp;\n  export let onRightClick;\n  export let transitionTime = 0.2;\n  export let styles;\n  export let mainDown;\n  export let secondaryDown;\n\n  const white = '#eee';\n  const black = '#111';\n  const red = '#d22';\n  let hover = false;\n\n  $: bg = state === -2 ? red : (state === -1 ? white : color);\n  $: textColor = tinycolor(bg).isLight() ? black : white;\n  $: _styles = `background: ${bg}; color: ${textColor}; transition: all ${transitionTime}s ease-in-out;${!!styles ? styles : ''}`;\n</script>\n\n<style>\n  div {\n    align-items: center;\n    background: white;\n    border: 1px solid rgba(0, 0, 0, 0.4);\n    box-sizing: border-box;\n    cursor: pointer;\n    display: flex;\n    font-size: 14px;\n    justify-content: center;\n    height: 48px;\n    width: 48px;\n    position: relative;\n  }\n\n  .debug {\n    font-size: 6px;\n    position: absolute;\n    background: #fff;\n    color: #111;\n    top: 0;\n    left: 0;\n    padding: 1px;\n    height: 10px;\n    width: 10px;\n  }\n</style>\n\n<div\n  style=\"{_styles}\"\n  on:click={() => {\n    if (onClick) {\n      onClick(row, col);\n    }\n  }}\n  on:mousedown={() => {\n    if (onMouseDown) {\n      onMouseDown(row, col);\n    }\n  }}\n  on:mouseup={() => {\n    if (onMouseUp) {\n      onMouseUp(row, col);\n    }\n  }}\n  on:mouseenter={() => {\n    hover = true;\n    if (onMouseEnter) {\n      onMouseEnter(row, col);\n    }\n  }}\n  on:mouseover={() => {\n    if (onMouseOver) {\n      onMouseOver(row, col);\n    }\n  }}\n  on:mouseleave={() => {\n    hover = false;\n    if (onMouseLeave) {\n      onMouseLeave(row, col);\n    }\n  }}\n  on:contextmenu={(e) => {\n    if (onRightClick) {\n      e.preventDefault();\n      onRightClick(row, col);\n    }\n  }}\n>\n  <div class=\"debug\">\n    {state}\n  </div>\n  <slot />\n</div>"
  ],
  "names": [],
  "mappings": "AAkHE,EAAE,cAAC,CAAC,AACF,KAAK,CAAE,IAAI,CACX,SAAS,CAAE,MAAM,CACjB,UAAU,CAAE,MAAM,CAClB,cAAc,CAAE,SAAS,AAC3B,CAAC,AAED,KAAK,cAAC,CAAC,AACL,UAAU,CAAE,MAAM,CAClB,OAAO,CAAE,IAAI,AACf,CAAC,AAED,SAAS,cAAC,CAAC,AACT,OAAO,CAAE,IAAI,AACf,CAAC,AAED,SAAS,cAAC,CAAC,AACT,OAAO,CAAE,IAAI,CACb,cAAc,CAAE,MAAM,AACxB,CAAC,AAED,eAAe,cAAC,CAAC,AACf,eAAe,CAAE,MAAM,AACzB,CAAC,AAED,cAAc,cAAC,CAAC,AACd,aAAa,CAAE,IAAI,AACrB,CAAC,AAED,MAAM,cAAC,CAAC,AACN,OAAO,CAAE,IAAI,CACb,QAAQ,CAAE,GAAG,AACf,CAAC;ACpHD,GAAG,cAAC,CAAC,AACH,WAAW,CAAE,MAAM,CACnB,UAAU,CAAE,KAAK,CACjB,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CACpC,UAAU,CAAE,UAAU,CACtB,MAAM,CAAE,OAAO,CACf,OAAO,CAAE,IAAI,CACb,SAAS,CAAE,IAAI,CACf,eAAe,CAAE,MAAM,CACvB,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,IAAI,CACX,QAAQ,CAAE,QAAQ,AACpB,CAAC,AAED,MAAM,cAAC,CAAC,AACN,SAAS,CAAE,GAAG,CACd,QAAQ,CAAE,QAAQ,CAClB,UAAU,CAAE,IAAI,CAChB,KAAK,CAAE,IAAI,CACX,GAAG,CAAE,CAAC,CACN,IAAI,CAAE,CAAC,CACP,OAAO,CAAE,GAAG,CACZ,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,IAAI,AACb,CAAC"
}